{"version":3,"file":"osana.client.js","mappings":"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","sources":["webpack://osana/./src/lib/client/element.ts","webpack://osana/./src/lib/client/navigator.ts","webpack://osana/webpack/bootstrap","webpack://osana/./src/lib/client/location.ts","webpack://osana/./src/lib/client/storage.ts","webpack://osana/./src/lib/client/window.ts","webpack://osana/./src/lib/client/message.ts","webpack://osana/./src/lib/client/fetch.ts","webpack://osana/./src/lib/client/history.ts","webpack://osana/./src/lib/client/xmlhttp.ts","webpack://osana/./src/lib/client/request.ts","webpack://osana/./src/lib/client/beacon.ts","webpack://osana/./src/lib/client/websocket.ts","webpack://osana/./src/lib/client/eval.ts","webpack://osana/./src/lib/client/worker.ts","webpack://osana/./src/lib/client/open.ts","webpack://osana/./src/lib/client/index.ts"],"sourcesContent":["const rewriteURL = self.__osana$bundle.rewrite.url;\r\nconst rewriteCSS = self.__osana$bundle.rewrite.css;\r\nconst rewriteJS = self.__osana$bundle.rewrite.js;\r\nconst rewriteHTML = self.__osana$bundle.rewrite.html;\r\nconst rewriteSrcset = self.__osana$bundle.rewrite.srcset;\r\nconst attributes = {\r\n    \"href\": [HTMLAnchorElement, HTMLLinkElement, HTMLAreaElement, HTMLBaseElement],\r\n    \"src\": [HTMLAudioElement, HTMLEmbedElement, HTMLIFrameElement, HTMLImageElement, HTMLInputElement, HTMLScriptElement, HTMLSourceElement, HTMLTrackElement, HTMLVideoElement],\r\n    \"srcset\": [HTMLImageElement, HTMLSourceElement],\r\n    \"action\": [HTMLFormElement]\r\n};\r\n// Element.seAttribute\r\nconst setterApply = Object.getOwnPropertyDescriptor(Element.prototype, \"setAttribute\").value;\r\nElement.prototype.setAttribute = function (name, value) {\r\n    if (attributes[name]) {\r\n        for (let i in attributes[name]) {\r\n            if (this instanceof attributes[name][i]) {\r\n                setterApply.apply(this, [name, rewriteURL(value)]);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    if (name === undefined || value === undefined)\r\n        throw new TypeError(`Failed to execute 'setAttribute' on 'Element': 2 arguments required, but only ${!name && !value ? 0 : 1} present.`);\r\n    setterApply.apply(this, [name, value]);\r\n};\r\n// Element[attribute]\r\nObject.keys(attributes).forEach((attribute) => {\r\n    attributes[attribute].forEach((element) => {\r\n        try {\r\n            // URL based attributes\r\n            if ([\"href\", \"src\", \"srcset\", \"action\"].includes(attribute)) {\r\n                const { set, get } = Object.getOwnPropertyDescriptor(element.prototype, attribute);\r\n                Object.defineProperty(element.prototype, attribute, {\r\n                    set(value) {\r\n                        return set.call(this, [rewriteURL(value)]);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        catch (_a) { }\r\n    });\r\n});\r\n// Element.innerHTML\r\nconst { set } = Object.getOwnPropertyDescriptor(Element.prototype, \"innerHTML\");\r\nObject.defineProperty(Element.prototype, \"innerHTML\", {\r\n    set(value) {\r\n        if (this instanceof HTMLScriptElement) {\r\n            return set.call(this, rewriteJS(value));\r\n        }\r\n        else if (this instanceof HTMLStyleElement) {\r\n            return set.call(this, rewriteCSS(value));\r\n        }\r\n        return set.call(this, rewriteHTML(value));\r\n    }\r\n});\r\n","Object.defineProperty(navigator, \"serviceWorker\", {});\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const config = self.__osana$config;\r\nexport function getLocation(scope) {\r\n    try {\r\n        let fakeLocation = new URL(config.codec.decode(location.pathname.replace(new RegExp(`^${config.prefix}`), \"\")));\r\n        if (scope) {\r\n            fakeLocation.href = new URL(config.codec.decode(scope.location.pathname.replace(new RegExp(`^${config.prefix}`), \"\")));\r\n        }\r\n        fakeLocation.ancestorOrigins = { length: 0 };\r\n        fakeLocation.assign = (url) => location.assign(config.prefix + config.codec.encode(url));\r\n        fakeLocation.reload = () => location.reload();\r\n        fakeLocation.replace = (url) => location.replace(config.prefix + config.codec.encode(url));\r\n        fakeLocation.toString = () => fakeLocation.href;\r\n        return fakeLocation;\r\n    }\r\n    catch (_a) {\r\n        return {};\r\n    }\r\n}\r\nwindow.Location = class {\r\n};\r\nexport class LocationProxy {\r\n    constructor(scope) {\r\n        return new Proxy(new Location(), {\r\n            get(target, prop, receiver) {\r\n                let fakeLocation = getLocation(scope);\r\n                return fakeLocation[prop];\r\n            },\r\n            set(target, prop, value) {\r\n                let fakeLocation = getLocation(scope);\r\n                fakeLocation[prop] = value;\r\n                location.pathname = config.prefix + config.codec.encode(fakeLocation.href);\r\n                return fakeLocation[prop];\r\n            }\r\n        });\r\n    }\r\n}\r\nexport default new LocationProxy();\r\n","import LocationProxy from \"./location\";\r\nfunction createStorageProxy(scope) {\r\n    return new Proxy({\r\n        getItem(key) {\r\n            return scope.getItem(`${key}@${LocationProxy.host}`);\r\n        },\r\n        setItem(key, value) {\r\n            scope.setItem(`${key}@${LocationProxy.host}`, value);\r\n        },\r\n        removeItem(key) {\r\n            scope.removeItem(`${key}@${LocationProxy.host}`);\r\n        },\r\n        clear() {\r\n            Object.keys(scope).forEach((key) => {\r\n                if (new RegExp(`@${LocationProxy.host}$`).test(key)) {\r\n                    this.removeItem(key.replace(new RegExp(`@${LocationProxy.host}$`), \"\"));\r\n                }\r\n            });\r\n        }\r\n    }, {\r\n        get(target, prop, receiver) {\r\n            if (prop === \"length\") {\r\n                return Object.keys(scope).filter((key) => new RegExp(`@${LocationProxy.host}$`).test(key)).length;\r\n            }\r\n            else if ([\"getItem\", \"setItem\", \"removeItem\", \"clear\"].includes(prop)) {\r\n                return target[prop];\r\n            }\r\n            else {\r\n                return target.getItem(prop);\r\n            }\r\n        },\r\n        set(target, prop, value) {\r\n            return target.setItem(prop, value);\r\n        }\r\n    });\r\n}\r\nconst idbopen = indexedDB.open;\r\nindexedDB.open = (name, version) => {\r\n    return idbopen.call(indexedDB, `${name}@${LocationProxy.host}`, version);\r\n};\r\nif (window.hasOwnProperty(\"openDatabase\")) {\r\n    const odb = openDatabase;\r\n    openDatabase = (name, version, displayName, maxSize) => {\r\n        return odb(`${name}@${LocationProxy.host}`, version, displayName, maxSize);\r\n    };\r\n}\r\nwindow.__localStorage = createStorageProxy(localStorage);\r\nwindow.__sessionStorage = createStorageProxy(sessionStorage);\r\n","import { LocationProxy } from \"./location\";\r\nexport class WindowProxy {\r\n    constructor(scope) {\r\n        return new Proxy(scope, {\r\n            get(target, prop, receiver) {\r\n                if (prop === \"location\") {\r\n                    return new LocationProxy(target);\r\n                }\r\n                else if ([\"parent\", \"top\"].includes(prop)) {\r\n                    if (window === window[prop])\r\n                        return window.__window;\r\n                    else\r\n                        return new WindowProxy(target[prop]);\r\n                }\r\n                else if ([\"window\", \"self\", \"globalThis\"].includes(prop)) {\r\n                    return new WindowProxy(target);\r\n                }\r\n                else if (prop === \"localStorage\") {\r\n                    return window.__localStorage;\r\n                }\r\n                else if (prop === \"sessionStorage\") {\r\n                    return window.__sessionStorage;\r\n                }\r\n                return target[prop];\r\n            },\r\n            set(target, prop, value) {\r\n                return Reflect.set(scope, prop, value);\r\n            }\r\n        });\r\n    }\r\n}\r\nexport default new WindowProxy(window);\r\n","import { WindowProxy } from \"./window\";\r\nexport default class MessageProxy {\r\n    constructor(scope) {\r\n        return new Proxy(scope.addEventListener, {\r\n            apply(target, thisArg, args) {\r\n                if (args[0] && args[1]) {\r\n                    if (args[0] === \"message\") {\r\n                        args[1] = new Proxy(args[1], {\r\n                            apply(target, thisArg, args) {\r\n                                args[0] = new Proxy(args[0], {\r\n                                    get(target, prop, receiver) {\r\n                                        if (prop === \"origin\")\r\n                                            return __location.origin;\r\n                                        if (prop === \"path\")\r\n                                            target[prop].map((win) => new WindowProxy(win));\r\n                                        if (prop === \"currentTarget\")\r\n                                            return new WindowProxy(target[prop]);\r\n                                        if (prop === \"source\")\r\n                                            return new WindowProxy(target[prop]);\r\n                                        if (prop === \"srcElement\")\r\n                                            return new WindowProxy(target[prop]);\r\n                                        if (prop === \"target\")\r\n                                            return new WindowProxy(target[prop]);\r\n                                        return target[prop];\r\n                                    }\r\n                                });\r\n                                return Reflect.apply(target, thisArg, args);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                return Reflect.apply(target, thisArg, args);\r\n            }\r\n        });\r\n    }\r\n}\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nexport default new Proxy(fetch, {\r\n    apply(target, thisArg, args) {\r\n        if (args[0])\r\n            args[0] = rewriteURL(args[0]);\r\n        return Reflect.apply(target, thisArg, args);\r\n    }\r\n});\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nconst config = self.__osana$config;\r\nconst pushState = new Proxy(window.history.pushState, {\r\n    apply(target, thisArg, args) {\r\n        if (new RegExp(`^${config.prefix}`).test(args[2]))\r\n            return;\r\n        args[2] = rewriteURL(args[2]);\r\n        Reflect.apply(target, thisArg, args);\r\n    }\r\n});\r\nconst replaceState = new Proxy(window.history.replaceState, {\r\n    apply(target, thisArg, args) {\r\n        if (new RegExp(`^${config.prefix}`).test(args[2]))\r\n            return;\r\n        args[2] = rewriteURL(args[2]);\r\n        Reflect.apply(target, thisArg, args);\r\n    }\r\n});\r\nexport { pushState, replaceState };\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nconst XMLOpen = window.XMLHttpRequest.prototype.open;\r\nexport default function (...args) {\r\n    if (args[1])\r\n        args[1] = rewriteURL(args[1]);\r\n    return XMLOpen.call(this, ...args);\r\n}\r\n;\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nconst config = self.__osana$config;\r\nexport default new Proxy(Request, {\r\n    construct(target, args) {\r\n        if (args[0])\r\n            args[0] = rewriteURL(args[0]);\r\n        return new Proxy(Reflect.construct(target, args), {\r\n            get(target, prop, receiver) {\r\n                if (prop === \"url\") {\r\n                    let fakeLocation = new URL(config.codec.decode(location.pathname.replace(new RegExp(`^${config.prefix}`), \"\")));\r\n                    return fakeLocation.href;\r\n                }\r\n                return target[prop];\r\n            }\r\n        });\r\n    }\r\n});\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nexport default new Proxy(navigator.sendBeacon, {\r\n    apply(target, thisArg, args) {\r\n        if (args[0])\r\n            args[0] = rewriteURL(args[0]);\r\n        return Reflect.apply(target, thisArg, args);\r\n    }\r\n});\r\n","import locationProxy from \"./location\";\r\nconst encodeProtocol = self.__osana$bundle.rewrite.protocol;\r\nconst v4 = self.__osana$bundle.uuid;\r\nconst config = self.__osana$config;\r\nconst websockets = new Map();\r\nexport default new Proxy(WebSocket, {\r\n    construct(target, args, newTarget) {\r\n        if (args[0]) {\r\n            const url = new URL(args[0]);\r\n            const id = v4();\r\n            websockets.set(id, url.toString());\r\n            const request = {\r\n                remote: {\r\n                    host: url.hostname,\r\n                    port: url.port || (url.protocol === \"wss:\" ? \"443\" : \"80\"),\r\n                    path: url.pathname + url.search,\r\n                    protocol: url.protocol\r\n                },\r\n                headers: {\r\n                    Host: url.host,\r\n                    Origin: locationProxy.origin,\r\n                    Pragma: \"no-cache\",\r\n                    \"Cache-Control\": \"no-cache\",\r\n                    Upgrade: \"websocket\",\r\n                    Connection: \"Upgrade\"\r\n                },\r\n                forward_headers: [\"accept-encoding\", \"accept-language\", \"sec-websocket-extensions\", \"sec-websocket-key\", \"sec-websocket-version\"]\r\n            };\r\n            const bareURL = new URL(config.bare);\r\n            return Reflect.construct(target, [location.protocol.replace(\"http\", \"ws\") + \"//\" + (bareURL.host + bareURL.pathname) + `v1/?${id}`, [\"bare\", encodeProtocol(JSON.stringify(request))]]);\r\n        }\r\n        return Reflect.construct(target, args, newTarget);\r\n    }\r\n});\r\nconst websocketURL = Object.getOwnPropertyDescriptor(WebSocket.prototype, \"url\");\r\nObject.defineProperty(WebSocket.prototype, \"url\", {\r\n    get() {\r\n        const url = websocketURL.get.call(this);\r\n        const id = new URL(url).search.substring(1);\r\n        return websockets.get(id);\r\n    }\r\n});\r\n","const rewriteJS = self.__osana$bundle.rewrite.js;\r\nexport default new Proxy(eval, {\r\n    apply(target, thisArg, argumentsList) {\r\n        if (argumentsList[0])\r\n            argumentsList[0] = rewriteJS(argumentsList[0]);\r\n        return Reflect.apply(target, thisArg, argumentsList);\r\n    }\r\n});\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nexport default new Proxy(window.Worker, {\r\n    construct(target, args, newTarget) {\r\n        if (args[0])\r\n            args[0] = rewriteURL(args[0]);\r\n        return Reflect.construct(target, args, newTarget);\r\n    }\r\n});\r\n","const rewriteURL = self.__osana$bundle.rewrite.url;\r\nexport default new Proxy(window.open, {\r\n    apply(target, thisArg, args) {\r\n        if (args[0] && args[0] !== \"about:blank\")\r\n            args[0] = rewriteURL(args[0]);\r\n        Reflect.apply(target, thisArg, args);\r\n    }\r\n});\r\n","import \"./element\";\r\nimport \"./storage\";\r\nimport \"./navigator\";\r\nimport MessageProxy from \"./message\";\r\nimport FetchProxy from \"./fetch\";\r\nimport * as History from \"./history\";\r\nimport LocationProxy from \"./location\";\r\nimport WindowProxy from \"./window\";\r\nimport XMLHttpRequestProxy from \"./xmlhttp\";\r\nimport RequestProxy from \"./request\";\r\nimport BeaconProxy from \"./beacon\";\r\nimport WebSocketProxy from \"./websocket\";\r\nimport EvalProxy from \"./eval\";\r\nimport WorkerProxy from \"./worker\";\r\nimport OpenProxy from \"./open\";\r\nwindow.fetch = FetchProxy;\r\nwindow.Request = RequestProxy;\r\nwindow.history.pushState = History.pushState;\r\nwindow.history.replaceState = History.replaceState;\r\nwindow.__parent = WindowProxy.parent;\r\nwindow.__top = WindowProxy.top;\r\nwindow.__window = WindowProxy;\r\nwindow.__location = LocationProxy;\r\nwindow.__self = WindowProxy;\r\nwindow.XMLHttpRequest.prototype.open = XMLHttpRequestProxy;\r\nnavigator.sendBeacon = BeaconProxy;\r\nwindow.WebSocket = WebSocketProxy;\r\nwindow.eval = EvalProxy;\r\nwindow.Worker = WorkerProxy;\r\nwindow.open = OpenProxy;\r\nwindow.addEventListener = new MessageProxy(window);\r\nwindow.Worker.prototype.addEventListener = new MessageProxy(window.Worker.prototype);\r\n"],"names":["rewriteURL","self","__osana$bundle","rewrite","url","rewriteCSS","css","rewriteJS","js","rewriteHTML","html","attributes","srcset","HTMLAnchorElement","HTMLLinkElement","HTMLAreaElement","HTMLBaseElement","HTMLAudioElement","HTMLEmbedElement","HTMLIFrameElement","HTMLImageElement","HTMLInputElement","HTMLScriptElement","HTMLSourceElement","HTMLTrackElement","HTMLVideoElement","HTMLFormElement","setterApply","Object","getOwnPropertyDescriptor","Element","prototype","value","setAttribute","name","i","this","apply","undefined","TypeError","keys","forEach","attribute","element","includes","set","get","defineProperty","call","_a","HTMLStyleElement","navigator","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","config","__osana$config","getLocation","scope","fakeLocation","URL","codec","decode","location","pathname","replace","RegExp","prefix","href","ancestorOrigins","length","assign","encode","reload","toString","window","Location","LocationProxy","constructor","Proxy","target","prop","receiver","createStorageProxy","getItem","key","setItem","removeItem","clear","test","filter","idbopen","indexedDB","open","version","hasOwnProperty","odb","openDatabase","displayName","maxSize","__localStorage","localStorage","__sessionStorage","sessionStorage","WindowProxy","__window","Reflect","MessageProxy","addEventListener","thisArg","args","__location","origin","map","win","fetch","pushState","history","replaceState","XMLOpen","XMLHttpRequest","Request","construct","sendBeacon","encodeProtocol","protocol","v4","uuid","websockets","Map","WebSocket","newTarget","id","request","remote","host","hostname","port","path","search","headers","Host","Origin","Pragma","Upgrade","Connection","forward_headers","bareURL","bare","JSON","stringify","websocketURL","substring","eval","argumentsList","Worker","__parent","__top","__self"],"sourceRoot":""}